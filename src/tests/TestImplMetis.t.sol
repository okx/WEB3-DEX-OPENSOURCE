pragma solidity 0.8.20;

import "forge-std/Test.sol";

contract ImplTest is Test {
    function setUp() public {}

    function test_upgrade_metis_20240418() public {
        address dexRouter = 0x6b2C0c7be2048Daa9b5527982C29f48062B34D58;
        address newImpl = 0x6BDc7e17be5CdBd2777B6f5C3ECF145387506395;
        vm.createSelectFork(
            "https://andromeda.metis.io/?owner=1088",
            16678947 - 1
        );
        vm.store(
            dexRouter,
            0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc,
            bytes32(uint256(uint160(newImpl)))
        );
        address user = 0xb55473ba1d4DB59BFAEbbBE1bd9AcFE78C187225;
        bytes
            memory data = hex"b80c2f090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bb06dca3ae6887fabf931640f67cab3e3a16f4dc000000000000000000000000ea32a96608495e54156ae48931a7c20f0dcc1a2100000000000000000000000000000000000000000000000000000000009a46d400000000000000000000000000000000000000000000000000000000008a5bd90000000000000000000000000000000000000000000000000000000066222fac0000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000009a46d4000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000160000000000000000000000000bb06dca3ae6887fabf931640f67cab3e3a16f4dc00000000000000000000000000000000000000000000000000000000000000010000000000000000000000001672bf6cefead677b720cec58d77afc0c11349fc00000000000000000000000000000000000000000000000000000000000000010000000000000000000000001672bf6cefead677b720cec58d77afc0c11349fc00000000000000000000000000000000000000000000000000000000000000010000000000000000000027106c4768d4b3acd4a3ff01f179faffdaebe084d12d00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000";
        vm.startPrank(user);
        (bool s, ) = dexRouter.call(data);
        require(s);
    }
}
